<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Directed Symbolic Execution | Ivan Pustogarov</title> <meta name="author" content="Ivan Pustogarov"/> <meta name="description" content="Program analysis to synthesize sensor spoofing attacks in embedded systems"/> <meta name="keywords" content="anonymity, privacy, cybercrime, security, vulnerability"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://www.ipust.net/projects/2_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://www.ipust.net/"><span class="font-weight-bold">Ivan</span> Pustogarov</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">research</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Directed Symbolic Execution</h1> <p class="post-description">Program analysis to synthesize sensor spoofing attacks in embedded systems</p> </header> <article> <p><a href="https://github.com/ivanpustogarov/DrE" title="GitHub" target="_blank" rel="noopener noreferrer"><i class="fab fa-github" style="font-size:18px">  https://github.com/ivanpustogarov/DrE</i></a></p> <p>In this project, we targeted embedded systems. We looked at how program analysis can be used to find sensor spoofing vulnerabilities in embedded system firmware. A sensor spoofing attack is a type of of attack in which an adversary modifies the physical environment in a certain way so as to force an embedded system into unwanted or unintended behaviors. For example, an attacker controlling speech recognition interfaces with nonsensical noise which is erroneously interpreted as commands by the firmware algorithm.</p> <p>In this project, we targeted systems powered by MSP430 family of microcontrollers from Texas instruments that are used by a large number of embedded devices; and we developed a new symbolic execution framework, called DrE, that can be used to find such signal spoofing vulnerabilities in embedded code firmware.</p> <h3 id="sensor-spoofing">Sensor spoofing</h3> <p>The explosion in the popularity of embedded systems is fueled in large part by their ability to sense, interpret, and react to physical environments. For example, gesture recognition systems measure signals and interpret them as user commands, cameras that sense motion or light help autonomous systems navigate, and temperature sensors inform household HVAC systems. Software controlling embedded systems is often designed assuming a benign environment, for example, a device owner interacting with his own device. In real-world deployments, however, it is necessary to consider sensor spoofing threats. An attacker with direct or indirect access to the physical environment can emit physical signals that maliciously force unwanted or unintended behaviors in the victim software and, consequently, in the system controlled by this software.</p> <p>Some of the examples include disrupting the flight of autonomous drones using sound generated by off-the-shelf computer speakers or laser pointers, injecting bogus signals into medical devices, controlling speech recognition interfaces with nonsensical noise, and many others. These attacks are usually developed by manual reverse engineering and experimentation.</p> <h3 id="synthesizing-sensor-spoofing-attacks">Synthesizing sensor spoofing attacks.</h3> <p>In this project, we initiated research on software analysis tools that can help discover and exploit sensor spoofing vulnerabilities in embedded software. We focused on a popular class of embedded systems: lightweight microcontrollers attached to one or more sensor components. The sensors convert physical readings (temperature, light, sound, electromagnetic signals, etc.) into digital values that are read by the microcontroller’s firmware. Such systems are ubiquitous in so-called Internet-of-Things (IoT) applications, autonomous vehicles, and elsewhere. In sensor spoofing attack, the adversary’s goal is to infer which digital inputs to the firmware will force the behavior the adversary wants.</p> <h3 id="symbolic-execution-for-embedded-systems">Symbolic execution for embedded systems</h3> <p>We wanted to build a tool that can automatically discover sequences of digital sensor readings that drive the firmware to an adversarially chosen state. This includes possible sequences that the firmware designers did not expect. This is a problem well-suited for symbolic execution, given its ability to automatically generate inputs that drive the program into particular execution paths. As a result, we developed DrE (Directed Execution), a symbolic execution tool specifically engineered to analyze embedded firmware code with respect to signal input spoofing.</p> <h4 id="directed">Directed</h4> <p>To handle the challenges of analyzing embedded firmware, DrE uses a modular approach that takes advantage of both directed and compositional symbolic execution. Instead of attempting to explore all code paths, directed symbolic execution starts with a target, i.e., a particular point of interest in the program. In our context, these points are sections of the firmware code corresponding to the control actions that the attacker wants to firmware to take. The output of a successful directed symbolic execution is a path, defined as a set of constraints on inputs (i.e., sensor readings) that, if satisfied, will drive the program to the designated point.</p> <h4 id="compositional">Compositional</h4> <p>To mitigate path explosion, we devised a modular strategy to efficiently find paths to program points of interest. It uses a combination of call graph and control flow graph analysis with compositional symbolic execution. DrE starts by finding possible call chains from the program’s entry point to the function containing the target line. It then symbolically executes the function containing the target point and proceeds through a call chain backwards. Each function along the way is symbolically executed independently. To generate inter-procedural path constraints, DrE then stitches together the execution paths of individual functions. To do this, DrE collects, rewrites, and propagates the relevant constraints and performs a forward pass to check them. For efficiency, DrE employs several additional heuristics. DrE biases state selection towards shorter paths leading to the target program point and employs a state-pruning strategy to break out of infinite wait loops.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0">Last updated: June 09, 2022. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>